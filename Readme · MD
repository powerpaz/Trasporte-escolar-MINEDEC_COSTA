# ğŸšŒ Sistema de Rutas de Transporte Escolar MINEDU

Sistema web para mapear y calcular rutas de transporte escolar terrestre y fluvial, diseÃ±ado para el modelamiento de transporte del MINEDU en diferentes regÃ­menes educativos (Sierra, Costa, Selva).

## ğŸ¯ CaracterÃ­sticas

- âœ… **Carga de datos desde Excel/CSV** con coordenadas de unidades educativas
- âœ… **Mapeo interactivo** de unidades EJE y absorbidas
- âœ… **CÃ¡lculo automÃ¡tico de rutas** usando OpenStreetMap
- âœ… **MÃºltiples tipos de transporte**: Terrestre, a pie, fluvial
- âœ… **CÃ¡lculo de distancias y tiempos** aproximados
- âœ… **VisualizaciÃ³n de rutas** en mapa interactivo
- âœ… **ExportaciÃ³n de resultados** en formato JSON
- âœ… **Filtrado por rÃ©gimen educativo** (Sierra, Costa, Selva)
- âœ… **Interfaz moderna y responsive**

## ğŸ“‹ Requisitos

- Navegador web moderno (Chrome, Firefox, Edge, Safari)
- Archivo Excel o CSV con las siguientes columnas mÃ­nimas:
  - Coordenadas de unidad EJE (latitud_eje, longitud_eje)
  - Coordenadas de unidad absorbida (latitud_absorbida, longitud_absorbida)
  - Nombre de las unidades
  - RÃ©gimen (opcional: sierra, costa, selva)

## ğŸš€ InstalaciÃ³n

### OpciÃ³n 1: Uso Local Simple

1. **Descargar los archivos**:
   - `index.html`
   - `app.js`

2. **Abrir el archivo**:
   ```bash
   # Simplemente abre index.html en tu navegador
   # O usa un servidor local:
   python -m http.server 8000
   # Luego ve a: http://localhost:8000
   ```

### OpciÃ³n 2: Servidor Web

1. **Copiar archivos al servidor**:
   ```bash
   # Subir a tu servidor web (Apache, Nginx, etc.)
   scp index.html app.js usuario@servidor:/var/www/html/rutas-minedu/
   ```

2. **Configurar servidor** (ejemplo Nginx):
   ```nginx
   server {
       listen 80;
       server_name rutas-minedu.tudominio.com;
       root /var/www/html/rutas-minedu;
       index index.html;
   }
   ```

## ğŸ“Š Formato de Datos de Excel

### Estructura Recomendada

Tu archivo Excel debe tener al menos las siguientes columnas:

| nombre_ie_eje | latitud_eje | longitud_eje | nombre_ie_absorbida | latitud_absorbida | longitud_absorbida | regimen |
|---------------|-------------|--------------|---------------------|-------------------|-------------------|---------|
| IE 12345 Lima | -12.0464 | -77.0428 | IE 67890 Callao | -12.0544 | -77.1181 | costa |
| IE JosÃ© MarÃ­a Arguedas | -13.1631 | -74.2236 | IE San Juan | -13.1531 | -74.2436 | sierra |

### Columnas Detectadas AutomÃ¡ticamente

El sistema detecta automÃ¡ticamente columnas con nombres como:
- **Latitud**: `latitud`, `lat`, `latitude`, `lat_eje`, `latitud_eje`, etc.
- **Longitud**: `longitud`, `lon`, `longitude`, `lng`, `lon_eje`, etc.
- **Nombre**: `nombre`, `unidad`, `ie`, `colegio`, etc.
- **RÃ©gimen**: `regimen`, `rÃ©gimen`, `regime`

### Formatos Soportados

- **Excel**: `.xlsx`, `.xls`
- **CSV**: `.csv`
- **Coordenadas**: Formato decimal (ejemplo: -12.0464, -77.0428)

## ğŸ® Uso del Sistema

### 1. Cargar Datos

1. Haz clic en "ğŸ“‚ Cargar Base de Datos" o arrastra tu archivo Excel
2. El sistema procesarÃ¡ automÃ¡ticamente las coordenadas
3. VerÃ¡s una vista previa de los datos cargados
4. Los marcadores aparecerÃ¡n en el mapa:
   - ğŸ”µ Azul (E) = Unidad EJE
   - ğŸŸ£ Morado (A) = Unidad Absorbida

### 2. Seleccionar RÃ©gimen

- Haz clic en los botones: **Sierra**, **Costa**, o **Selva**
- El sistema filtrarÃ¡ las unidades correspondientes

### 3. Configurar Ruta

1. Selecciona una **Unidad EJE** (origen)
2. Selecciona una **Unidad Absorbida** (destino)
3. Elige el **Tipo de Transporte**:
   - ğŸš— Terrestre (Carretera)
   - ğŸš¶ A pie
   - â›µ Fluvial

### 4. Calcular Ruta

1. Haz clic en **"Calcular Ruta"**
2. El sistema calcularÃ¡ la mejor ruta usando OpenStreetMap
3. VerÃ¡s:
   - LÃ­nea de ruta en el mapa
   - Distancia total en kilÃ³metros
   - Tiempo estimado de viaje
   - Detalles de la ruta

### 5. Exportar Resultados

- Haz clic en **"Exportar Ruta"** para descargar un archivo JSON con:
  - Coordenadas de origen y destino
  - Distancia y tiempo calculados
  - GeometrÃ­a completa de la ruta
  - Fecha y hora del cÃ¡lculo

## ğŸ”§ TecnologÃ­as Utilizadas

- **Leaflet.js**: Mapas interactivos
- **Leaflet Routing Machine**: CÃ¡lculo de rutas
- **OSRM (OpenStreetMap Routing Machine)**: Motor de rutas
- **SheetJS (xlsx)**: Lectura de archivos Excel
- **HTML5 / CSS3 / JavaScript**: Interfaz web moderna

## ğŸ“ Estructura del Proyecto

```
rutas-minedu/
â”‚
â”œâ”€â”€ index.html          # Interfaz principal
â”œâ”€â”€ app.js             # LÃ³gica de la aplicaciÃ³n
â”œâ”€â”€ README.md          # Este archivo
â””â”€â”€ ejemplo_datos.xlsx # Archivo de ejemplo (crear)
```

## ğŸŒ APIs Utilizadas

### OpenStreetMap Routing Service (OSRM)

El sistema utiliza el servicio pÃºblico de OSRM para calcular rutas:
- **URL**: `https://router.project-osrm.org/route/v1`
- **Gratis**: SÃ­, pero con lÃ­mites de uso
- **DocumentaciÃ³n**: http://project-osrm.org/

### Alternativas Recomendadas para ProducciÃ³n

Para uso intensivo, considera instalar tu propio servidor OSRM:

1. **OSRM Backend**:
   ```bash
   docker run -t -v $(pwd):/data osrm/osrm-backend osrm-extract -p /opt/car.lua /data/peru-latest.osm.pbf
   docker run -t -v $(pwd):/data osrm/osrm-backend osrm-contract /data/peru-latest.osrm
   docker run -d -p 5000:5000 -v $(pwd):/data osrm/osrm-backend osrm-routed /data/peru-latest.osrm
   ```

2. **Modificar app.js**:
   ```javascript
   // Cambiar la URL del servicio
   router: L.Routing.osrmv1({
       serviceUrl: 'http://tu-servidor:5000/route/v1'
   })
   ```

## ğŸš€ Mejoras Futuras Sugeridas

### Funcionalidades Adicionales

- [ ] **CÃ¡lculo masivo**: Procesar mÃºltiples rutas simultÃ¡neamente
- [ ] **ExportaciÃ³n a Excel**: Generar reportes en formato XLSX
- [ ] **AnÃ¡lisis de costos**: Calcular costos de combustible y mantenimiento
- [ ] **OptimizaciÃ³n de flotas**: Asignar vehÃ­culos Ã³ptimamente
- [ ] **Historial de rutas**: Guardar y comparar cÃ¡lculos anteriores
- [ ] **Modo offline**: Trabajar sin conexiÃ³n usando datos precargados
- [ ] **IntegraciÃ³n con GPS**: Rastreo en tiempo real
- [ ] **Reportes PDF**: Generar documentos imprimibles

### Mejoras TÃ©cnicas

- [ ] **Base de datos**: PostgreSQL + PostGIS para almacenamiento
- [ ] **Backend API**: Node.js/Python para procesamiento avanzado
- [ ] **AutenticaciÃ³n**: Sistema de usuarios y permisos
- [ ] **CachÃ© de rutas**: Almacenar rutas calculadas
- [ ] **ValidaciÃ³n avanzada**: Verificar calidad de datos
- [ ] **Tests automatizados**: Garantizar calidad del cÃ³digo

## ğŸ› SoluciÃ³n de Problemas

### El mapa no se muestra

- Verifica tu conexiÃ³n a internet
- AsegÃºrate de que no haya bloqueadores de scripts
- Abre la consola del navegador (F12) para ver errores

### Las rutas no se calculan

- Verifica que las coordenadas sean vÃ¡lidas
- Comprueba que haya conexiÃ³n a internet
- Intenta con otro tipo de transporte
- Revisa que OSRM estÃ© disponible: https://router.project-osrm.org/

### El archivo Excel no se carga

- Verifica que el formato sea .xlsx o .xls
- AsegÃºrate de que tenga columnas de coordenadas
- Revisa que las coordenadas estÃ©n en formato decimal
- Prueba con un archivo mÃ¡s pequeÃ±o primero

### Coordenadas incorrectas

- Las coordenadas de PerÃº estÃ¡n aproximadamente en:
  - Latitud: -0Â° a -18Â° (negativos)
  - Longitud: -68Â° a -81Â° (negativos)
- Formato: decimal, no DMS (grados, minutos, segundos)

## ğŸ“ Soporte

Para reportar problemas o sugerir mejoras:
- Revisa la consola del navegador (F12)
- Documenta los pasos para reproducir el error
- Incluye capturas de pantalla si es posible

## ğŸ“„ Licencia

Este proyecto estÃ¡ basado en tecnologÃ­as de cÃ³digo abierto:
- Leaflet.js (BSD-2-Clause)
- OpenStreetMap (ODbL)
- OSRM (BSD-2-Clause)

## ğŸ™ CrÃ©ditos

- **OpenStreetMap**: Datos cartogrÃ¡ficos
- **OSRM Project**: Motor de cÃ¡lculo de rutas
- **Leaflet**: Biblioteca de mapas
- **MINEDU**: Contexto y requisitos del proyecto

---

**Desarrollado para**: Ministerio de EducaciÃ³n del PerÃº (MINEDU)  
**PropÃ³sito**: Modelamiento de Transporte Escolar Terrestre y Fluvial  
**VersiÃ³n**: 1.0.0  
**Fecha**: Noviembre 2025
